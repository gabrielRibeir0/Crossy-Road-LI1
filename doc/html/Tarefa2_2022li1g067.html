<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Tarefa2_2022li1g067</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption empty">&nbsp;</span><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>Jos&#233; Lu&#237;s Matos Ribeiro  &lt;a105108@alunos.uminho.pt&gt;<br />Gabriel Pereira Ribeiro  &lt;a104171@alunos.uminho.pt&gt;</td></tr><tr><th>Safe Haskell</th><td>Safe-Inferred</td></tr></table><p class="caption">Tarefa2_2022li1g067</p></div><div id="table-of-contents"><div id="contents-list"><p class="caption" onclick="window.scrollTo(0,0)">Contents</p><ul><li><a href="#g:1">Fun&#231;&#227;o principal</a></li><li><a href="#g:2">Fun&#231;&#245;es auxiliares</a></li></ul></div></div><div id="description"><p class="caption">Description</p><div class="doc"><p>M&#243;dulo para a realiza&#231;&#227;o da Tarefa 2 do projeto de LI1 em 2022/23.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:estendeMapa">estendeMapa</a> :: <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a> -&gt; Int -&gt; <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a></li><li class="src short"><a href="#v:proximosTerrenosValidos">proximosTerrenosValidos</a> :: <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a> -&gt; [<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>]</li><li class="src short"><a href="#v:escolheTerreno">escolheTerreno</a> :: Int -&gt; [<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>] -&gt; <a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a></li><li class="src short"><a href="#v:velocidadeAleatoria">velocidadeAleatoria</a> :: Int -&gt; <a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a> -&gt; <a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a> -&gt; <a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a></li><li class="src short"><a href="#v:proximosObstaculosValidos">proximosObstaculosValidos</a> :: Int -&gt; (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]) -&gt; [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]</li><li class="src short"><a href="#v:escolheObstaculo">escolheObstaculo</a> :: Int -&gt; <a href="LI12223.html#t:Largura" title="LI12223">Largura</a> -&gt; (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]) -&gt; <a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a></li><li class="src short"><a href="#v:listaObstaculo">listaObstaculo</a> :: Int -&gt; <a href="LI12223.html#t:Largura" title="LI12223">Largura</a> -&gt; <a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a> -&gt; [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]</li></ul></details></div><div id="interface"><a href="#g:1" id="g:1"><h1>Fun&#231;&#227;o principal</h1></a><div class="top"><p class="src"><a id="v:estendeMapa" class="def">estendeMapa</a> :: <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a> -&gt; Int -&gt; <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a> <a href="#v:estendeMapa" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o principal, <code><a href="Tarefa2_2022li1g067.html#v:estendeMapa" title="Tarefa2_2022li1g067">estendeMapa</a></code> acrescenta uma linha nova no topo do mapa dado.</p><pre>estendeMapa :: Mapa -&gt; Int -&gt; Mapa
estendeMapa (Mapa l ll) n
    | obsV2 (velocidadeAleatoria n terreno t) (listaObstaculo n l terreno) &amp;&amp; validaPassagemEntreArvores (velocidadeAleatoria n terreno t, listaObstaculo n l terreno) ll = Mapa l ((velocidadeAleatoria n terreno t, listaObstaculo n l terreno): ll)
    | otherwise = estendeMapa (Mapa l ll) (n+1)
    where terreno | null ll = Relva
                  | otherwise =  escolheTerreno n (proximosTerrenosValidos (Mapa l ll))
          t | null ll = Relva
            | otherwise = fst(head ll)
</pre><p>Para respeitar as restri&#231;&#245;es impostas para ser um mapa v&#225;lido, esta fun&#231;&#227;o recorre &#224; fun&#231;&#227;o da Tarefa 1 <code>mapaValido</code> tem algumas fun&#231;&#245;es auxiliares.</p></div></div><a href="#g:2" id="g:2"><h1>Fun&#231;&#245;es auxiliares</h1></a><div class="top"><p class="src"><a id="v:proximosTerrenosValidos" class="def">proximosTerrenosValidos</a> :: <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a> -&gt; [<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>] <a href="#v:proximosTerrenosValidos" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2022li1g067.html#v:proximosTerrenosValidos" title="Tarefa2_2022li1g067">proximosTerrenosValidos</a></code> que indica os terrenos que &#233; poss&#237;vel escolher tendo em conta o resto do mapa.</p><pre>proximosTerrenosValidos (Mapa _ []) = [Relva]
proximosTerrenosValidos (Mapa _ ((Rio _, _):(Rio _, _):(Rio _, _):(Rio _, _):t)) = [Estrada 0, Relva]
proximosTerrenosValidos (Mapa _ ((Relva,_):(Relva,_):(Relva,_):(Relva,_):(Relva,_):t)) = [Rio 0, Estrada 0]
proximosTerrenosValidos (Mapa _ ((Estrada _, _):(Estrada _, _):(Estrada _, _):(Estrada _, _):(Estrada _,_):t)) = [Relva, Rio 0]
proximosTerrenosValidos (Mapa _ _) = [Relva, Rio 0, Estrada 0]
</pre></div></div><div class="top"><p class="src"><a id="v:escolheTerreno" class="def">escolheTerreno</a> :: Int -&gt; [<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>] -&gt; <a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a> <a href="#v:escolheTerreno" class="selflink">#</a></p><div class="doc"><p><code><a href="Tarefa2_2022li1g067.html#v:escolheTerreno" title="Tarefa2_2022li1g067">escolheTerreno</a></code> para escolher um terreno da lista de terrenos v&#225;lidos.</p><pre>escolheTerreno n (h:t) | mod n 3 == 0 = h
                       | mod n 3 == 1 = head t
                       | otherwise = last t
</pre><p>Recorre ao resultado de <em><strong>mod n 3</strong></em> para ter alguma pseudo-aleatoriedade na escolha do mapa.</p></div></div><div class="top"><p class="src"><a id="v:velocidadeAleatoria" class="def">velocidadeAleatoria</a> :: Int -&gt; <a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a> -&gt; <a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a> -&gt; <a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a> <a href="#v:velocidadeAleatoria" class="selflink">#</a></p><div class="doc"><p><code><a href="Tarefa2_2022li1g067.html#v:velocidadeAleatoria" title="Tarefa2_2022li1g067">velocidadeAleatoria</a></code> para atribuir uma velocidade ao terreno escolhido.</p><pre>velocidadeAleatoria _ Relva _ = Relva
velocidadeAleatoria n (Rio v) (Rio v0) | v0 &gt; 0 = if even n then Rio (-1) else Rio (-2)
                                       | otherwise =  if even n then Rio 1 else Rio 2
velocidadeAleatoria n (Estrada v) (Estrada v0) | v0 &gt; 0 = if even n then Estrada (-1) else Estrada (-2)
                                               | otherwise =  if even n then Estrada 1 else Estrada 2
velocidadeAleatoria n (Rio v) _ | mod n 4 == 0 = Rio 1
                                | mod n 4 == 1 = Rio (-1)
                                | mod n 4 == 2 = Rio 2
                                | otherwise = Rio (-2)
velocidadeAleatoria n (Estrada v) _ | mod n 4 == 0 = Estrada 1
                                    | mod n 4 == 1 = Estrada (-1)
                                    | mod n 4 == 2 = Estrada 2
                                    | otherwise = Estrada (-2)
</pre><p>Tamb&#233;m acrescenta alguma aleatoriedade com o resultado da express&#227;o <em><strong>mod n 4</strong></em>.</p></div></div><div class="top"><p class="src"><a id="v:proximosObstaculosValidos" class="def">proximosObstaculosValidos</a> :: Int -&gt; (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]) -&gt; [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>] <a href="#v:proximosObstaculosValidos" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2022li1g067.html#v:proximosObstaculosValidos" title="Tarefa2_2022li1g067">proximosObstaculosValidos</a></code> para devolver a lista de obst&#225;culos v&#225;lidos, tendo em conta as restri&#231;&#245;es de tamanho de objetos e tipo de terreno.</p><pre>proximosObstaculosValidos l (Rio _, []) = [Nenhum,Tronco]
proximosObstaculosValidos l (Estrada _, []) = [Nenhum,Carro]
proximosObstaculosValidos l (Relva , os) | length os &gt;= l = [] 
                                         | otherwise = if elem Nenhum os then [Nenhum, Arvore] else [Nenhum]
proximosObstaculosValidos l (Rio _, os) | length os &gt;= l = []
                                        | length os &gt; 4 = if elem Nenhum (take 5 os) then [Nenhum,Tronco] else [Nenhum]
                                        | otherwise = if elem Nenhum os &amp;&amp; not(elem Tronco os) then [Tronco] else if elem Nenhum os then [Nenhum,Tronco] else [Nenhum] 
proximosObstaculosValidos l (Estrada  _, os) | length os &gt;= l = []
                                             | length os &gt; 2 = if elem Nenhum (take 3 os) then [Nenhum,Carro] else [Nenhum]
                                             | otherwise = if elem Nenhum os then [Nenhum, Carro] else [Nenhum]
</pre></div></div><div class="top"><p class="src"><a id="v:escolheObstaculo" class="def">escolheObstaculo</a> :: Int -&gt; <a href="LI12223.html#t:Largura" title="LI12223">Largura</a> -&gt; (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]) -&gt; <a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a> <a href="#v:escolheObstaculo" class="selflink">#</a></p><div class="doc"><p><code><a href="Tarefa2_2022li1g067.html#v:escolheObstaculo" title="Tarefa2_2022li1g067">escolheObstaculo</a></code> para escolher um obst&#225;culo, com alguma aleatoriedade (se o n&#250;mero n, aleat&#243;rio, for par ou &#237;mpar)</p><pre>escolheObstaculo n l (t,os) | even n = head obsv
                            | otherwise = last obsv
    where obsv = proximosObstaculosValidos l (t,os)
</pre></div></div><div class="top"><p class="src"><a id="v:listaObstaculo" class="def">listaObstaculo</a> :: Int -&gt; <a href="LI12223.html#t:Largura" title="LI12223">Largura</a> -&gt; <a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a> -&gt; [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>] <a href="#v:listaObstaculo" class="selflink">#</a></p><div class="doc"><p><code><a href="Tarefa2_2022li1g067.html#v:listaObstaculo" title="Tarefa2_2022li1g067">listaObstaculo</a></code> para criar a lista de obst&#225;culos v&#225;lidos at&#233; atingir a largura do mapa.</p><pre>listaObstaculo n 0 t = []
listaObstaculo n l t = escolheObstaculo n l (t,o) : o
    where o = listaObstaculo n (l-1) t
</pre></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.26.0</p></div></body></html>